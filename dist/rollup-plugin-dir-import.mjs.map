{"version":3,"file":"rollup-plugin-dir-import.mjs","sources":["../src/index.js"],"sourcesContent":["const path = require('path');\nconst fs = require('fs-extra');\nconst dir = /^(.*)\\/\\*(\\?importer=(.+)){0,1}$/;\n\nmodule.exports = () => {\n  return {\n    name: 'dir-import',\n    async resolveId(importee, importer) {\n      if (importee.match(dir)) {\n        return path.join(path.dirname(importer), importee) + `?importer=${importer}`;\n      }\n\n      return null;\n    },\n    async load(id, ...rest) {\n      const match = id.match(dir);\n\n      if (match) {\n        const folder = match[1];\n        const importer = match[3];\n        const files = await fs.readdir(folder);\n\n        let exports = [];\n        let output = '';\n        await Promise.all(files\n          .filter(file => ['.js', '.ts', '.json', '.jsx', '.tsx'].includes(path.extname(file)))\n          .map(async (file) => {\n            const name = `a${Math.random().toString(36).substring(7)}`;\n            const from = await this.resolveId(path.join(folder, file));\n\n            if (from !== importer) {\n              output += `import { default as ${name} } from \"${from}\";\\n`;\n              exports.push(name);\n            }\n          }));\n\n        output += `export default [${exports.join(',')}];\\n`;\n\n        return output;\n      }\n\n      return null;\n    }\n  };\n};\n"],"names":["const","path","require","fs","dir","module","exports","name","resolveId","importee","importer","match","join","dirname","load","id","readdir","folder","then","output","Promise","all","$await_2","filter","file","includes","extname","map","Math","random","toString","substring","this","from","$await_3","push"],"mappings":"AAAAA,IAAMC,EAAOC,QAAQ,QACfC,EAAKD,QAAQ,YACbE,EAAM,mCAEZC,OAAOC,0BAEHC,KAAM,aACAC,mBAAUC,EAAUC,GAAX,iCACb,OAAID,EAASE,MAAMP,KACVH,EAAKW,KAAKX,EAAKY,QAAQH,GAAWD,GAAY,aAAaC,KAG7D,SAEHI,cAAKC,iEAAD,+CAGR,OAFMJ,EAAQI,EAAGJ,MAAMP,KAIfM,EAAWC,EAAM,GACHR,EAAGa,QAFjBC,EAASN,EAAM,IAEPO,gCAId,OAFIZ,KACAa,EAAS,GACPC,QAAQC,IAJAC,EAKXC,gBAAOC,UAAS,MAAO,MAAO,QAAS,OAAQ,QAAQC,SAASxB,EAAKyB,QAAQF,MAC7EG,aAAWH,4CAEG,OADPjB,EAAO,IAAIqB,KAAKC,SAASC,SAAS,IAAIC,UAAU,GACnCC,KAAKxB,UAAUP,EAAKW,KAAKK,EAAQO,IAAvCN,4BAAPe,EAAOC,KAEAxB,IACXS,GAAU,uBAAuBZ,cAAgB0B,SACjD3B,EAAQ6B,KAAK5B,+CARnBW,qBAcA,OAFAC,GAAU,mBAAmBb,EAAQM,KAAK,cAEnCO,0DAGF"}